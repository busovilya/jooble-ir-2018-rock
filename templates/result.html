<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>First app</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='script.js') }}"></script>
    <style>

    .autocomplete-items {
            position: absolute;
            margin-left: 30px;
            background-color: white;
    }
        
     * {
        box-sizing: border-box;
     }
   
    .content {
        margin-top: 30px;
        margin-left: 30px;
        width: 85%;
        overflow: hidden;
        background-color: white;
    }

    #block {
        display: block;
        color: black;
        text-align: left;
        padding: 14px 16px;
        text-decoration: none;
    }

    #title {
        color: blue;
        font-size: 22px;
        text-decoration: None;
        
        text-decoration: none;
    }


    /* Change color on hover */
    #title:hover {
        text-decoration: underline;
    }
    
    #title:visited {
        color: pink;
        text-decoration: none;
    }
        
       input[type=text] {
            width: 90%;
            margin-left: 25px;
            margin-top: 15px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
            background-color: white;
            padding: 12px 20px 12px 20px;
        }   
        
        #cat {
            margin-bottom: 15px;          
        }
        /* Create three unequal columns that floats next to each other */
        .column {
            float: left;
        }
        
        /* Left column */
        .column.left {
            width: 65%;
        }
        /* Right column */
        .column.right {
            width: 35%;
        }
        
        /* Clear floats after the columns */
        .row:after {
            content: "";
            display: table;
            clear: both;
        }
    </style>
</head>

<body>
    <form method=post action="/search" name="Input" autocomplete="off">
        <div class="row">
            <div class="column left">
                <input type="text" name="query" id="query">
                <div class="content">
                    {% for doc in documents %}
                    <div id='block'>
                        <a id='title' href='{{ doc.url }}' target="_blank">{{ doc.title }}</a>
                        <br><small style="color: grey;">{{doc.profarea}}</small>
                        <div>{{ doc.snippet }}</div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="column right">
                <div style="margin-top: 100px;">
                    <ul id="similar" style="list-style-type: none; padding-left: 0px;">
                    </ul>
                </div>
                <div>
                    <h3>Free! Only today you can choose category:</h3>
                    <input type="checkbox" name="category" value="Банки, инвестиции, лизинг" id='cat'> Банки,
                    инвестиции, лизинг<br>
                    <input type="checkbox" name="category" value="Юристы" id='cat'> Юристы<br>
                    <input type="checkbox" name="category" value="Информационные технологии, интернет, телеком" id='cat'>
                    Информационные технологии, интернет, телеком<br>
                    <input type="checkbox" name="category" value="Наука, образование" id='cat'> Наука, образование<br>
                    <input type="checkbox" name="category" value="Производство" id='cat'> Производство<br>
                    <input type="checkbox" name="category" value="Туризм, гостиницы, рестораны" id='cat'> Туризм,
                    гостиницы, рестораны<br>
                    <input type="checkbox" name="category" value="Бухгалтерия, управленческий учет, финансы предприятия"
                        id='cat'> Бухгалтерия, управленческий учет, финансы предприятия<br>
                    <input type="checkbox" name="category" value="Начало карьеры, студенты" id='cat'> Начало карьеры,
                    студенты<br>
                    <input type="checkbox" name="category" value="Управление персоналом, тренинги" id='cat'> Управление
                    персоналом, тренинги<br>
                    <input type="checkbox" name="category" value="Продажи" id='cat'> Продажи<br>
                    <input type="checkbox" name="category" value="Транспорт, логистика" id='cat'> Транспорт, логистика<br>
                    <input type="checkbox" name="category" value="Медицина, фармацевтика" id='cat'> Медицина,
                    фармацевтика<br>
                    <input type="checkbox" name="category" value="Высший менеджмент" id='cat'> Высший менеджмент<br>
                    <input type="checkbox" name="category" value="Маркетинг, реклама, PR" id='cat'> Маркетинг, реклама,
                    PR<br>
                    <input type="checkbox" name="category" value="Автомобильный бизнес" id='cat'> Автомобильный бизнес<br>
                    <input type="checkbox" name="category" value="Закупки" id='cat'> Закупки<br>
                    <input type="checkbox" name="category" value="Строительство, недвижимость" id='cat'> Строительство,
                    недвижимость<br>
                    <input type="checkbox" name="category" value="Рабочий персонал" id='cat'> Рабочий персонал<br>
                    <input type="checkbox" name="category" value="Административный персонал" id='cat'> Административный
                    персонал<br>
                    <input type="checkbox" name="category" value="Инсталляция и сервис" id='cat'> Инсталляция и сервис<br>
                    <input type="checkbox" name="category" value="Безопасность" id='cat'> Безопасность<br>
                    <input type="checkbox" name="category" value="Искусство, развлечения, масс-медиа" id='cat'>
                    Искусство, развлечения, масс-медиа<br>
                    <input type="checkbox" name="category" value="Консультирование" id='cat'> Консультирование<br>
                    <input type="checkbox" name="category" value="Страхование" id='cat'> Страхование<br>
                    <input type="checkbox" name="category" value="Государственная служба, некоммерческие организации"
                        id='cat'> Государственная служба, некоммерческие организации<br>
                    <input type="checkbox" name="category" value="Домашний персонал" id='cat'> Домашний персонал<br>
                    <input type="checkbox" name="category" value="Добыча сырья" id='cat'> Добыча сырья<br>
                    <input type="checkbox" name="category" value="none" id='cat' checked hidden><br>

                </div>
            </div>
        </div>
    </form>
    <script>
        $('#query[type=text]').on('keydown', function (e) {
            if (e.which == 13) {
                $(document.forms.Input).submit();
            }
        });

        var f = document.forms.Input;
        f.onchange = function () {
            var n = f.querySelectorAll('[type="checkbox"]'),
                l = f.querySelectorAll('[type="checkbox"]:checked');
            for (var j = 0; j < n.length; j++)
                if (l.length >= 2) { // если отметить одну и более галочки
                    n[j].disabled = true; // все чекбоксы становятся disabled
                    for (var i = 0; i < l.length; i++)
                        l[i].disabled = false; // но disabled убирается с помеченных галочками чекбоксов
                } else {
                    n[j].disabled = false; // если выделить менее одной галочек, то disabled снимается со всех чекбоксов
                }
        }

        $(document).ready(function () {
            autocomplete(document.getElementById("query"), words);
            $.ajax({
                type: 'POST',
                url: 'http://127.0.0.1:13562/similar',
                data: JSON.stringify({
                    query: $('#query').val()
                }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (json) {
                    $('#similar').append("<strong><h3>Похожие запросы</h3></strong>")
                    for (var i = 0; i < json.length; i++) {
                        $('#similar').append('<li class="similars" style="margin-left:5px;"><a href="#">' + json[i]) + '</a></li>';
                    }

                    $('.similars').click(function () {
                        $('#query').val($(this).text());
                        $(document.forms.Input).submit();
                    });
                }
            })
        })
    </script>
    <script>

    </script>


</body>

</html>